<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Jogo da Cobrinha</title>
<style>
  * { box-sizing: border-box; }
  html, body {
    margin: 0;
    padding: 0;
    height: 100%;
    overflow: hidden; /* evita rolagem */
  }

  body {
    background: #0b1220;
    color: #e6eef8;
    font-family: Arial, sans-serif;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
  }

  canvas {
    border: 3px solid #122231;
    border-radius: 6px;
    width: 90vw;
    max-width: 90vh;
    max-height: 80vh;
    height: auto;
    display: block;
    margin: 10px auto;
  }

  #startScreen {
    position: fixed;
    top: 0; left: 0;
    width: 100%; height: 100%;
    background: rgba(11,18,32,0.95);
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    z-index: 10;
    padding: 20px;
    text-align: center;
  }

  #startScreen h1, #startScreen p {
    margin: 10px 0;
    padding: 10px;
    border: 2px solid #122231;
    border-radius: 8px;
    background-color: #0f1724;
    width: 90%;
    max-width: 400px;
  }

  #startScreen button {
    padding: 12px 25px;
    margin: 10px;
    border: none;
    border-radius: 8px;
    font-weight: bold;
    cursor: pointer;
    font-size: 16px;
    background: #06b6d4;
    color: #062024;
  }

  .hud {
    display: flex;
    justify-content: center;
    gap: 30px;
    font-size: 18px;
    margin-top: 10px;
    flex-wrap: wrap;
    padding: 10px;
  }

  .hud div {
    padding: 8px 12px;
    border: 2px solid #122231;
    border-radius: 6px;
    background-color: #0f1724;
    min-width: 100px;
  }

  @media (max-width: 480px) {
    .hud {
      flex-direction: column;
      align-items: center;
      gap: 10px;
    }

    #startScreen h1, #startScreen p {
      font-size: 18px;
    }

    #startScreen button {
      font-size: 14px;
    }
  }
</style>
</head>
<body>

<div id="startScreen">
  <h1>Cobrinha</h1>
  <p>Use as setas do teclado. Vidas: <span id="startLives">3</span></p>
  <button id="startBtn">Começar</button>
</div>

<div class="hud">
  <div>Pontos: <span id="score">0</span></div>
  <div>Vidas: <span id="lives">3</span></div>
  <div>Pausado: <span id="paused">Não</span></div>
</div>

<canvas id="game"></canvas>

<audio id="bgMusic" src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3" loop></audio>
<audio id="eatSound" src="https://actions.google.com/sounds/v1/cartoon/clang_and_wobble.ogg"></audio>
<audio id="hitSound" src="https://www.soundjay.com/button/button-10.wav"></audio>

<script>
const canvas = document.getElementById('game');
const ctx = canvas.getContext('2d');

const startScreen = document.getElementById('startScreen');
const startBtn = document.getElementById('startBtn');

const scoreEl = document.getElementById('score');
const livesEl = document.getElementById('lives');
const startLivesEl = document.getElementById('startLives');
const pausedEl = document.getElementById('paused');

const bgMusic = document.getElementById('bgMusic');
const eatSound = document.getElementById('eatSound');
const hitSound = document.getElementById('hitSound');

let snake = [];
let direction = 'RIGHT';
let food = {};
let score = 0;
let lives = 3;
let gameInterval;
let isPaused = false;

const gridSize = 20;
let cellSize;

const appleImg = new Image();
appleImg.src = 'https://upload.wikimedia.org/wikipedia/commons/1/15/Red_Apple.jpg';

function resizeCanvas() {
  const size = Math.min(window.innerWidth * 0.9, window.innerHeight * 0.8);
  canvas.width = size;
  canvas.height = size;
  cellSize = canvas.width / gridSize;
  drawGame();
}

window.addEventListener('resize', resizeCanvas);

function placeFood() {
  food = { x: Math.floor(Math.random() * gridSize), y: Math.floor(Math.random() * gridSize) };
}

function initGame() {
  resizeCanvas();
  snake = [{x:10, y:10}];
  direction = 'RIGHT';
  placeFood();
  score = 0;
  lives = 3;
  isPaused = false;
  scoreEl.textContent = score;
  livesEl.textContent = lives;
  startLivesEl.textContent = lives;
  pausedEl.textContent = 'Não';
  startScreen.style.display = 'none';
  bgMusic.play();
  if(gameInterval) clearInterval(gameInterval);
  gameInterval = setInterval(gameLoop, 150);
}

function gameLoop() {
  if(isPaused) return;

  const head = {...snake[0]};
  if(direction==='RIGHT') head.x++;
  if(direction==='LEFT') head.x--;
  if(direction==='UP') head.y--;
  if(direction==='DOWN') head.y++;

  if(head.x<0 || head.x>=gridSize || head.y<0 || head.y>=gridSize){
    loseLife();
    return;
  }

  if(snake.some(seg=>seg.x===head.x && seg.y===head.y)){
    loseLife();
    return;
  }

  snake.unshift(head);

  if(head.x===food.x && head.y===food.y){
    score += 10;
    scoreEl.textContent = score;
    eatSound.currentTime = 0;
    eatSound.play();
    placeFood();
  } else {
    snake.pop();
  }

  drawGame();
}

function loseLife() {
  lives--;
  livesEl.textContent = lives;
  startLivesEl.textContent = lives;
  hitSound.currentTime = 0;
  hitSound.play();
  if(lives <= 0){
    alert("Game Over!");
    startScreen.style.display = 'flex';
    clearInterval(gameInterval);
  } else {
    snake = [{x:10, y:10}];
    direction = 'RIGHT';
  }
}

function drawGrid() {
  ctx.fillStyle = "#0f1724";
  ctx.fillRect(0, 0, canvas.width, canvas.height);
  ctx.strokeStyle = "#122231";
  for(let x=0; x<=canvas.width; x+=cellSize){
    ctx.beginPath();
    ctx.moveTo(x,0);
    ctx.lineTo(x,canvas.height);
    ctx.stroke();
  }
  for(let y=0; y<=canvas.height; y+=cellSize){
    ctx.beginPath();
    ctx.moveTo(0,y);
    ctx.lineTo(canvas.width,y);
    ctx.stroke();
  }
}

function drawGame() {
  drawGrid();
  ctx.drawImage(appleImg, food.x*cellSize, food.y*cellSize, cellSize, cellSize);
  ctx.fillStyle="#ffffff";
  snake.forEach(seg => ctx.fillRect(seg.x*cellSize, seg.y*cellSize, cellSize, cellSize));
}

document.addEventListener('keydown', e=>{
  if(e.key==='ArrowUp' && direction!=='DOWN') direction='UP';
  if(e.key==='ArrowDown' && direction!=='UP') direction='DOWN';
  if(e.key==='ArrowLeft' && direction!=='RIGHT') direction='LEFT';
  if(e.key==='ArrowRight' && direction!=='LEFT') direction='RIGHT';
  if(e.code==='Space'){
    isPaused = !isPaused;
    pausedEl.textContent = isPaused ? 'Sim' : 'Não';
  }
});

startBtn.addEventListener('click', initGame);
</script>
</body>
</html>
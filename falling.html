<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kirby Game Neon</title>
<style>
  * { box-sizing:border-box; margin:0; padding:0; font-family:Arial,sans-serif; }
  body, html { height:100%; display:flex; flex-direction:column; justify-content:flex-start; align-items:center; background: radial-gradient(circle at top, #f9a8d4, #ec4899); overflow:hidden; }
  h2 { text-align:center; color:#fff; text-shadow:0 0 10px #ff77ff, 0 0 20px #ff44ff; margin:10px; font-size:1.4rem; }
  #hud { color:#fff; font-weight:bold; text-align:center; margin-bottom:10px; font-size:1.2rem; text-shadow:0 0 8px cyan, 0 0 15px #0ff; }
  #controls { text-align:center; margin-bottom:10px; }
  #controls button { font-size:1rem; padding:6px 12px; margin:0 5px; border:none; border-radius:6px; background:#06b6d4; color:#fff; font-weight:bold; cursor:pointer; box-shadow:0 0 8px #0ff, 0 0 12px #06b6d4; }
  #controls button:hover { background:#0891b2; box-shadow:0 0 12px #0ff, 0 0 16px #06b6d4; }
  #gameWrapper { position:relative; width:500px; height:600px; border:4px solid #ff77ff; border-radius:15px; box-shadow:0 0 20px #ff77ff, 0 0 40px #ff44ff inset; }
  canvas { background: rgba(0,0,0,0.2); border-radius:10px; display:block; margin:auto; box-shadow:0 0 10px #ff77ff, 0 0 20px #ff44ff inset; }
</style>
</head>
<body>

<h2>Kirby odeia bananas! Coma os inimigos e desvie das bananas!</h2>
<div id="hud">Pontos: 0 | Vidas: 3</div>
<div id="controls">
  <button id="startBtn">Start</button>
  <button id="restartBtn" style="display:none;">Reiniciar</button>
</div>

<div id="gameWrapper">
  <canvas id="gameCanvas" width="500" height="600"></canvas>
</div>

<audio id="bgMusic" src="Fundo.mp3" loop></audio>
<audio id="scoreSound" src="Ponto.mp3"></audio>
<audio id="hitSound" src="Dano.mp3"></audio>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");
const hud = document.getElementById("hud");
const startBtn = document.getElementById("startBtn");
const restartBtn = document.getElementById("restartBtn");
const bgMusic = document.getElementById("bgMusic");
const scoreSound = document.getElementById("scoreSound");
const hitSound = document.getElementById("hitSound");

// Imagens
const kirbyImg = new Image(); kirbyImg.src = 'Kirby.png';
const bananaImg = new Image(); bananaImg.src = 'banana.png';
const enemyImgs = [
  {img:new Image(), speed:2.5},
  {img:new Image(), speed:3.0},
  {img:new Image(), speed:1.8}
];
enemyImgs[0].img.src = 'Inimigo1.png';
enemyImgs[1].img.src = 'Inimigo2.png';
enemyImgs[2].img.src = 'Inimigo3.png';

// Variáveis do jogo
const GAME_WIDTH = 700, GAME_HEIGHT = 600;
const BORDER = 10; // Limite do quadrado neon
let player = {x:220, y:500, w:60, h:60, speed:6};
let objects = [];
let score = 0, lives = 3;
let running = false, gameOver = false;
let lastSpawn = 0, spawnInterval = 1000;
let keys = {left:false, right:false};

// HUD
function updateHUD() { hud.textContent = `Pontos: ${score} | Vidas: ${lives}`; }

// Colisão
function rectCollide(a,b){
  return a.x < b.x+b.w && a.x+a.w > b.x && a.y < b.y+b.h && a.y+a.h > b.y;
}

// Spawn inimigos e bananas respeitando limite
function spawnObject(){
  const size = 40;
  const x = BORDER + Math.random() * (GAME_WIDTH - 2*BORDER - size);
  const rand = Math.random();
  let obj = {};
  
  if(rand < 0.6){
    const enemyIndex = Math.floor(Math.random()*enemyImgs.length);
    obj = {x:x, y:BORDER-size, w:size, h:size, vy:enemyImgs[enemyIndex].speed, type:"enemy", img:enemyImgs[enemyIndex].img};
  } else {
    obj = {x:x, y:BORDER-size, w:size, h:size, vy:2.0+Math.random()*2, type:"banana", img:bananaImg};
  }
  objects.push(obj);
}

// Update
function update(delta){
  if(!running) return;
  lastSpawn += delta;
  if(lastSpawn>spawnInterval){ spawnObject(); lastSpawn=0; spawnInterval=Math.max(500, spawnInterval-5); }

  if(keys.left) player.x -= player.speed*(delta/16);
  if(keys.right) player.x += player.speed*(delta/16);

  // Limite do quadrado neon
  if(player.x<BORDER) player.x=BORDER;
  if(player.x+player.w>GAME_WIDTH-BORDER) player.x=GAME_WIDTH-BORDER-player.w;
  if(player.y<BORDER) player.y=BORDER;
  if(player.y+player.h>GAME_HEIGHT-BORDER) player.y=GAME_HEIGHT-BORDER-player.h;

  for(let i=objects.length-1;i>=0;i--){
    const obj=objects[i];
    obj.y+=obj.vy*(delta/16);

    // Limite inferior do quadrado neon
    if(obj.y + obj.h > GAME_HEIGHT-BORDER) obj.y = GAME_HEIGHT-BORDER-obj.h;

    if(rectCollide(player,obj)){
      if(obj.type==="enemy"){ score++; scoreSound.currentTime=0; scoreSound.play(); }
      else { lives--; hitSound.currentTime=0; hitSound.play(); if(lives<=0){endGame(); return;} }
      objects.splice(i,1);
      updateHUD();
      continue;
    }

    if(obj.y>GAME_HEIGHT) objects.splice(i,1);
  }
}

// Draw com efeito neon
function draw(){
  ctx.clearRect(0,0,GAME_WIDTH,GAME_HEIGHT);

  // Limite da tela
  ctx.strokeStyle="#ff44ff";
  ctx.lineWidth=4;
  ctx.shadowColor="#ff77ff";
  ctx.shadowBlur=20;
  ctx.strokeRect(BORDER,BORDER,GAME_WIDTH-2*BORDER,GAME_HEIGHT-2*BORDER);

  // Kirby
  ctx.drawImage(kirbyImg, player.x, player.y, player.w, player.h);

  // Objetos
  for(const obj of objects){
    ctx.shadowColor = obj.type==="enemy" ? "#0ff" : "#ff0";
    ctx.shadowBlur=15;
    ctx.drawImage(obj.img, obj.x, obj.y, obj.w, obj.h);
  }
  ctx.shadowBlur=0;
}

// Loop principal
let lastTime=0;
function loop(ts){
  if(!running) return;
  if(!lastTime) lastTime=ts;
  const delta = ts-lastTime;
  lastTime=ts;
  update(delta);
  draw();
  requestAnimationFrame(loop);
}

// Start/End
function startGame(){
  objects=[]; score=0; lives=3; running=true; gameOver=false; lastSpawn=0; spawnInterval=1000; player.x=(GAME_WIDTH-player.w)/2;
  updateHUD();
  bgMusic.currentTime=0; bgMusic.play().catch(()=>{});
  lastTime=0; requestAnimationFrame(loop);
  startBtn.style.display="none"; restartBtn.style.display="none";
}

function endGame(){
  running=false; gameOver=true; bgMusic.pause();
  restartBtn.style.display="inline-block"; startBtn.style.display="none";
  setTimeout(()=>alert(`Game Over! Pontos: ${score}`),50);
}

// Eventos teclado
window.addEventListener("keydown",e=>{
  if(e.key==="ArrowLeft"||e.key==="a") keys.left=true;
  if(e.key==="ArrowRight"||e.key==="d") keys.right=true;
});
window.addEventListener("keyup",e=>{
  if(e.key==="ArrowLeft"||e.key==="a") keys.left=false;
  if(e.key==="ArrowRight"||e.key==="d") keys.right=false;
});

startBtn.addEventListener("click",()=>startGame());
restartBtn.addEventListener("click",()=>startGame());

updateHUD();
</script>
</body>
</html>

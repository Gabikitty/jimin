<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Jogo da Velha - 10 Rodadas</title>
<style>
html, body {
  margin:0; padding:0;
  height:100%; width:100%;
  display:flex; flex-direction:column;
  align-items:center; justify-content:center;
  font-family:Arial, sans-serif;
  background:#1e293b; color:#e2e8f0;
  overflow:hidden;
}
#gameWrapper {
  display:flex; flex-direction:column;
  align-items:center; justify-content:center;
  width:100%; max-width:1000px;
  height:100%;
  padding:20px;
  box-sizing:border-box;
}
h1 {
  margin:0 0 20px 0;
  text-align:center;
  font-size:clamp(2.5rem, 4vw, 4.5rem);
  text-shadow:0 0 25px #38bdf8;
  line-height:1.2;
}
.hud {
  display:flex;
  justify-content:center;
  gap:40px;
  width:100%;
  font-weight:bold;
  margin-bottom:20px;
  font-size:clamp(1.2rem, 2vw, 1.8rem);
  flex-wrap:wrap;
  text-align:center;
}
#boardContainer {
  display:flex; align-items:center; justify-content:center;
}
#board {
  display:grid;
  grid-template-columns: repeat(3, 1fr);
  grid-template-rows: repeat(3, 1fr);
  grid-gap:25px;
  width:min(80vw, 450px);
  height:min(80vw, 450px);
}
.cell {
  background:#111827;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:clamp(2.5rem, 8vw, 6rem);
  cursor:pointer;
  border-radius:12px;
  text-shadow:0 0 20px #fff;
  user-select:none;
}
.cell.X { color:#f43f5e; text-shadow:0 0 20px #f43f5e; }
.cell.O { color:#3b82f6; text-shadow:0 0 20px #3b82f6; }
#menuScreen, #aiOptions {
  display:flex; flex-direction:column;
  align-items:center;
  margin-top:20px;
  background:#334155;
  padding:30px 40px;
  border-radius:12px;
  box-shadow:0 0 20px #38bdf8;
  width:90%; max-width:450px;
}
button, select {
  margin-top:15px;
  padding:14px 28px;
  border:none; border-radius:10px;
  background:#0ea5e9; color:white;
  font-size:clamp(1rem, 1.5vw, 1.3rem);
  cursor:pointer;
  box-shadow:0 0 15px #0ea5e9;
  width:100%; max-width:260px;
}
#aiOptions .option {
  display:flex; flex-direction:column;
  align-items:flex-start;
  margin-top:15px;
  width:100%;
}
#aiOptions label {
  font-size:clamp(0.95rem, 1.4vw, 1.2rem);
  color:#e2e8f0;
  margin-bottom:6px;
}
#aiOptions select {
  width:100%;
  padding:10px 18px;
  border-radius:8px;
  border:none;
  background:#0ea5e9;
  color:white;
  font-size:clamp(0.9rem, 1.2vw, 1.1rem);
  box-shadow:0 0 12px #0ea5e9;
  cursor:pointer;
}
#message {
  position: absolute;
  top:20px;
  left:50%;
  transform:translateX(-50%);
  padding:12px 20px;
  border-radius:8px;
  font-size:1.2rem;
  font-weight:bold;
  text-align:center;
  display:none;
  background:#0f172a;
  box-shadow:0 0 12px #38bdf8;
  z-index:1000;
}
</style>
</head>
<body>

<div id="gameWrapper">
  <h1>✨ Jogo da Velha ✨</h1>
  <div class="hud">
    <div>Pontos X: <span id="scoreX">0</span></div>
    <div>Pontos O: <span id="scoreO">0</span></div>
    <div>Rodada: <span id="round">1</span>/10</div>
  </div>

  <div id="message"></div>

  <div id="menuScreen">
    <p>Escolha o modo de jogo:</p>
    <button id="singleBtn">Contra IA</button>
    <button id="multiBtn">Multiplayer Local</button>
  </div>

  <div id="aiOptions" style="display:none;">
    <div class="option">
      <label for="playerSymbol">Escolha seu símbolo:</label>
      <select id="playerSymbol">
        <option value="X">❌ X</option>
        <option value="O">⭕ O</option>
      </select>
    </div>
    <div class="option">
      <label for="difficulty">Dificuldade:</label>
      <select id="difficulty">
        <option value="easy">Fácil</option>
        <option value="medium" selected>Médio</option>
        <option value="hard">Difícil</option>
      </select>
    </div>
    <button id="startAI">Iniciar</button>
  </div>

  <div id="boardContainer" style="display:none;">
    <div id="board"></div>
  </div>
</div>

<audio id="bgMusic" src="elec.mp3" loop autoplay></audio>
<audio id="clickSound" src="click.mp3"></audio>
<audio id="winSound" src="win.mp3"></audio>
<audio id="loseSound" src="lose.mp3"></audio>
<audio id="drawSound" src="draw.mp3"></audio>

<script>
const menuScreen=document.getElementById("menuScreen");
const aiOptions=document.getElementById("aiOptions");
const singleBtn=document.getElementById("singleBtn");
const multiBtn=document.getElementById("multiBtn");
const startAI=document.getElementById("startAI");
const boardEl=document.getElementById("board");
const boardContainer=document.getElementById("boardContainer");
const scoreXEl=document.getElementById("scoreX");
const scoreOEl=document.getElementById("scoreO");
const roundEl=document.getElementById("round");
const playerSymbolEl=document.getElementById("playerSymbol");
const difficultyEl=document.getElementById("difficulty");
const messageEl=document.getElementById("message");

// sons
const bgMusic=document.getElementById("bgMusic");
const clickSound=document.getElementById("clickSound");
const winSound=document.getElementById("winSound");
const loseSound=document.getElementById("loseSound");
const drawSound=document.getElementById("drawSound");

function playWithPause(sound){
  bgMusic.pause();
  sound.currentTime=0;
  sound.play();
  sound.onended=()=>{ bgMusic.play(); };
}

// Aviso funcionando corretamente
let messageTimeout;
function showMessage(text,color="#38bdf8") {
  clearTimeout(messageTimeout);
  messageEl.textContent=text;
  messageEl.style.color=color;
  messageEl.style.display="block";
  messageTimeout = setTimeout(()=>{ messageEl.style.display="none"; },2000);
}

let board=Array(9).fill(null);
let player="X", ai="O", mode="single", difficulty="medium";
let currentTurn="X", gameOver=false;
let scoreX=0, scoreO=0, round=1, maxRounds=10;

function createBoard(){
  boardEl.innerHTML="";
  board=Array(9).fill(null);
  gameOver=false;
  currentTurn="X";
  messageEl.style.display="none";
  for(let i=0;i<9;i++){
    const cell=document.createElement("div");
    cell.classList.add("cell");
    cell.dataset.index=i;
    cell.addEventListener("click",()=>playerMove(i));
    boardEl.appendChild(cell);
  }
}

function updateHUD(){
  scoreXEl.textContent=scoreX;
  scoreOEl.textContent=scoreO;
  roundEl.textContent=round;
}

function playerMove(i){
  if(gameOver||board[i]) return;
  clickSound.play();

  if(mode==="single"){
    board[i]=player; renderBoard();
    if(checkWinner(player)){
      scoreX++; playWithPause(winSound);
      endRound("Você ganhou!", "#22c55e"); return;
    }
    if(board.every(c=>c)){
      scoreX++; scoreO++; playWithPause(drawSound);
      endRound("Empate!", "#eab308"); return;
    }
    aiMove();
  } else {
    board[i]=currentTurn; renderBoard();
    if(checkWinner(currentTurn)){
      currentTurn==="X"?scoreX++:scoreO++;
      if(currentTurn===player) playWithPause(winSound); else playWithPause(loseSound);
      endRound(`Jogador ${currentTurn} ganhou!`, currentTurn===player?"#22c55e":"#ef4444"); return;
    }
    if(board.every(c=>c)){
      scoreX++; scoreO++; playWithPause(drawSound);
      endRound("Empate!", "#eab308"); return;
    }
    currentTurn=currentTurn==="X"?"O":"X";
  }
}

function aiMove(){
  const empty=board.map((v,i)=>v?null:i).filter(v=>v!==null);
  let move;
  if(difficulty==="easy"){ move=empty[Math.floor(Math.random()*empty.length)]; }
  else if(difficulty==="medium"){ move=Math.random()<0.5?findBestMove(ai):empty[Math.floor(Math.random()*empty.length)]; }
  else if(difficulty==="hard"){ move=findBestMove(ai); }

  board[move]=ai; renderBoard();
  if(checkWinner(ai)){scoreO++; playWithPause(loseSound); endRound("Você perdeu!", "#ef4444"); return;}
  if(board.every(c)){scoreX++;scoreO++; playWithPause(drawSound); endRound("Empate!", "#eab308"); return;}
}

function renderBoard(){
  document.querySelectorAll(".cell").forEach((c,i)=>{
    c.textContent=board[i]||"";
    c.className="cell "+(board[i]||"");
  });
}

function checkWinner(p){
  const wins=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];
  return wins.some(c=>c.every(i=>board[i]===p));
}

function findBestMove(playerSymbol){
  function minimax(b, depth, isMaximizing){
    if(checkWinner(ai)) return 10-depth;
    if(checkWinner(player)) return depth-10;
    if(b.every(c=>c)) return 0;
    const empty=b.map((v,i)=>v?null:i).filter(v=>v!==null);
    if(isMaximizing){
      let best=-Infinity;
      for(const i of empty){ b[i]=ai; best=Math.max(best,minimax(b,depth+1,false)); b[i]=null; }
      return best;
    } else {
      let best=Infinity;
      for(const i of empty){ b[i]=player; best=Math.min(best,minimax(b,depth+1,true)); b[i]=null; }
      return best;
    }
  }
  let bestScore=-Infinity, move;
  board.forEach((cell,i)=>{
    if(!cell){ board[i]=ai; let score=minimax(board,0,false); board[i]=null;
      if(score>bestScore){ bestScore=score; move=i; }
    }
  });
  return move;
}

function endRound(msg,color){
  gameOver=true;
  showMessage(msg,color);
  if(round>=maxRounds){
    if(scoreX===scoreO){
      showMessage("Empate geral! Rodadas bônus.", "#eab308");
      round++; createBoard(); updateHUD();
      if(mode==="single" && player==="O") aiMove();
      return;
    }
    showMessage(`Fim das ${maxRounds} rodadas! ${scoreX>scoreO?"X venceu!":"O venceu!"}`, scoreX>scoreO?"#22c55e":"#ef4444");
    scoreX=0; scoreO=0; round=1;
    menuScreen.style.display="flex";
    boardContainer.style.display="none";
    aiOptions.style.display="none";
    updateHUD();
  } else {
    round++; createBoard(); updateHUD();
    if(mode==="single" && player==="O") aiMove();
  }
}

// Botões
singleBtn.onclick=()=>{ menuScreen.style.display="none"; aiOptions.style.display="flex"; mode="single"; }
multiBtn.onclick=()=>{ menuScreen.style.display="none"; boardContainer.style.display="flex"; mode="multi"; createBoard(); }
startAI.onclick=()=>{
  player=playerSymbolEl.value;
  ai=(player==="X")?"O":"X";
  difficulty=difficultyEl.value;
  aiOptions.style.display="none";
  boardContainer.style.display="flex";
  createBoard();
};

updateHUD();
</script>
</body>
</html>

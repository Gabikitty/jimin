<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Jogo da Velha</title>
<style>
/* === SEU CSS INALTERADO === */
</style>
</head>
<body>
<div class="game-container">
  <button class="backBtn" onclick="goBack()">Voltar</button>

  <div id="startScreen">
    <h1>✨ Jogo da Velha ✨</h1>
    <p>Escolha o modo de jogo:</p>
    <button id="singleBtn">Contra IA</button>
    <button id="multiBtn">Multiplayer Local</button>

    <!-- dificuldade IA -->
    <div id="difficulty" style="margin-top:15px; display:none;">
      <p>Selecione a dificuldade:</p>
      <button onclick="setDifficulty('easy')">Fácil</button>
      <button onclick="setDifficulty('medium')">Médio</button>
      <button onclick="setDifficulty('hard')">Difícil</button>
    </div>
  </div>

  <div class="hud">
    <div>Pontos X: <span id="scoreX">0</span></div>
    <div>Pontos O: <span id="scoreO">0</span></div>
    <div>Rodada: <span id="round">1</span>/10</div>
  </div>

  <div id="board"></div>
  <div id="message"></div>

  <div class="other-games">
    <button onclick="window.location.href='Snake.html'">Snake</button>
    <button onclick="window.location.href='falling.html'">Falling</button>
  </div>
</div>

<audio id="bgMusic" src="elec.mp3" loop autoplay></audio>
<audio id="clickSound" src="click.mp3"></audio>
<audio id="winSound" src="win.mp3"></audio>
<audio id="loseSound" src="lose.mp3"></audio>
<audio id="drawSound" src="draw.mp3"></audio>

<script>
/* === SEU JS ORIGINAL INALTERADO ATÉ AS NOVAS FUNÇÕES === */

let board=[], player="X", ai="O", mode="single", currentTurn="X", gameOver=false;
let scoreX=0, scoreO=0, round=1, maxRounds=10;
let difficulty="easy"; // padrão

// Seleção de dificuldade
function setDifficulty(level){
  difficulty=level;
  document.getElementById("startScreen").style.display="none";
  createBoard();
}

// Botões de início
document.getElementById("singleBtn").onclick=()=>{
  mode="single";
  document.getElementById("difficulty").style.display="block";
};
document.getElementById("multiBtn").onclick=()=>{
  mode="multi"; startScreen.style.display="none"; createBoard();
};

// --- IA com dificuldades ---
function aiMove(){
  let move;
  const empty=board.map((v,i)=>v?null:i).filter(v=>v!==null);

  if(difficulty==="easy"){
    // aleatório
    move=empty[Math.floor(Math.random()*empty.length)];
  }
  else if(difficulty==="medium"){
    // tenta ganhar, senão bloquear, senão aleatório
    move=findBestMove(ai) || findBestMove(player) || empty[Math.floor(Math.random()*empty.length)];
  }
  else if(difficulty==="hard"){
    // minimax perfeito
    move=minimax(board, ai).index;
  }

  board[move]=ai;
  renderBoard();
  if(checkWinner(ai)){scoreO++; playWithPause(loseSound); endRound("Você perdeu!", "#ef4444"); return;}
  if(board.every(c=>c)){ scoreX++; scoreO++; playWithPause(drawSound); endRound("Empate!", "#eab308"); return;}
}

// Função para checar jogada imediata de vitória/bloqueio
function findBestMove(p){
  const wins=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];
  for(let combo of wins){
    const [a,b,c]=combo;
    if(board[a]===p && board[b]===p && !board[c]) return c;
    if(board[a]===p && board[c]===p && !board[b]) return b;
    if(board[b]===p && board[c]===p && !board[a]) return a;
  }
  return null;
}

// Algoritmo Minimax (IA impossível de vencer)
function minimax(newBoard, playerTurn){
  const availSpots=newBoard.map((v,i)=>v?null:i).filter(v=>v!==null);

  if(checkWinner(player)) return {score:-10};
  if(checkWinner(ai)) return {score:10};
  if(availSpots.length===0) return {score:0};

  const moves=[];
  for(let i=0;i<availSpots.length;i++){
    const idx=availSpots[i];
    const move={index:idx};
    newBoard[idx]=playerTurn;

    if(playerTurn===ai){
      const result=minimax(newBoard, player);
      move.score=result.score;
    } else {
      const result=minimax(newBoard, ai);
      move.score=result.score;
    }
    newBoard[idx]=null;
    moves.push(move);
  }

  let bestMove;
  if(playerTurn===ai){
    let bestScore=-Infinity;
    for(let m of moves){ if(m.score>bestScore){ bestScore=m.score; bestMove=m; } }
  } else {
    let bestScore=Infinity;
    for(let m of moves){ if(m.score<bestScore){ bestScore=m.score; bestMove=m; } }
  }
  return bestMove;
}

function goBack(){ window.location.href='index.html'; bgMusic.pause(); }
updateHUD();
</script>
</body>
</html>
